<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" />
  <meta name="theme-color" content="#19191B" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
  <title data-translate="page_title">Potok ‚Äî Home</title>
  
  <!-- Telegram Web App SDK -->
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  
  <!-- TON Connect SDK -->
  <script src="https://unpkg.com/@tonconnect/ui@latest/dist/tonconnect-ui.min.js"></script>
  
  <!-- –û—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π SDK Telegram Mini Apps Analytics -->
  <script src="https://cdn.jsdelivr.net/npm/telegram-mini-apps-analytics/dist/index.min.js"></script>
  
  <!-- Telegram Mini Apps Analytics SDK -->
  <script>
    // Telegram Analytics wrapper
    window.TelegramAnalytics = {
      track: function(eventName, parameters) {
        if (window.Telegram?.WebApp?.sendData) {
          try {
            const analyticsData = {
              event: eventName,
              params: parameters,
              timestamp: Date.now(),
              user_id: window.Telegram.WebApp.initDataUnsafe?.user?.id
            };
            console.log('üìä Analytics:', eventName, parameters);
            // –í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –∑–¥–µ—Å—å –±—É–¥–µ—Ç –æ—Ç–ø—Ä–∞–≤–∫–∞ –≤ Telegram Analytics
          } catch (error) {
            console.error('Analytics error:', error);
          }
        }
      }
    };
  </script>
  
  <style>
    /* CSS –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ */
    :root {
      --main: #19191B;
      --white: #ffffff;
      --text-2: #b3b3b3;
      --green: #34A853;
    }

    /* –°–±—Ä–æ—Å —Å—Ç–∏–ª–µ–π */
    * {
      box-sizing: border-box;
    }

    html, body {
      margin: 0;
      padding: 0;
      height: 100%;
      background-color: var(--main);
      font-family: "Inter", sans-serif;
    }

    h1, h2, h3, h4, h5, h6, p {
      margin: 0;
      padding: 0;
    }

    a {
      text-decoration: none;
      color: inherit;
    }

    /* Language Switcher */
    .language-switcher {
      position: fixed;
      top: 24px;
      right: 24px;
      z-index: 200;
      display: flex;
      gap: 8px;
      background: rgba(255, 255, 255, 0.05);
      padding: 4px;
      border-radius: 12px;
      backdrop-filter: blur(10px);
    }

    .lang-btn {
      background: none;
      border: none;
      color: var(--text-2);
      font-size: 12px;
      font-weight: 500;
      padding: 6px 12px;
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.2s;
      font-family: "Inter", sans-serif;
    }

    .lang-btn.active {
      background: var(--green);
      color: white;
    }

    .lang-btn:hover {
      background: rgba(255, 255, 255, 0.1);
    }

    .lang-btn.active:hover {
      background: var(--green);
    }

    /* –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä */
    .home {
      max-width: 375px;
      margin: 0 auto;
      padding: 96px 24px 24px 24px;
      display: flex;
      flex-direction: column;
      padding-bottom: 96px;
      box-sizing: border-box;
    }

    /* –•–µ–¥–µ—Ä —Å –ª–æ–≥–æ—Ç–∏–ø–æ–º/–∞–≤–∞—Ç–∞—Ä–æ–º */
    .logo {
      position: fixed;
      top: 0;
      left: 50%;
      transform: translateX(-50%);
      max-width: 375px;
      width: 100%;
      z-index: 100;
      background-color: var(--main);
      padding: 24px;
      box-sizing: border-box;
    }

    .logo img {
      height: 33px;
      width: auto;
      display: block;
    }

    .user-header {
      display: flex;
      align-items: center;
      gap: 16px;
      width: 100%;
    }

    .user-avatar {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      overflow: hidden;
      flex-shrink: 0;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .avatar-image {
      width: 100%;
      height: 100%;
      object-fit: cover;
      object-position: center center;
      display: block;
      border-radius: 50%;
    }

    .avatar-placeholder {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      background-color: rgba(255, 255, 255, 0.1);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 16px;
      font-weight: 600;
      color: var(--text-2);
    }

    .user-name {
      font-size: 18px;
      line-height: 24px;
      font-weight: 500;
      color: var(--white);
      flex: 1;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }

    .ton-connect-button {
      background: #0088cc;
      border: none;
      border-radius: 6px;
      padding: 6px 12px;
      color: white;
      font-size: 12px;
      font-weight: 500;
      cursor: pointer;
      transition: background-color 0.2s;
    }

    .ton-connect-button:hover {
      background: #0077bb;
    }

    /* –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π –±–ª–æ–∫ */
    .header {
      max-width: 327px;
      width: 100%;
      margin: 0 auto 48px auto;
      display: flex;
      flex-direction: column;
      gap: 4px;
    }

    .text-welcome {
      font-size: 14px;
      line-height: 20px;
      font-weight: 400;
      color: var(--text-2);
    }

    .text-title {
      font-size: 24px;
      line-height: 32px;
      font-weight: 600;
      background: linear-gradient(135deg, #FFD527 8%, #34A853 85%, #4285F4 98%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    /* –ö–∞—Ä—Ç–æ—á–∫–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–π */
    .cards {
      display: flex;
      flex-direction: column;
      gap: 24px;
      margin-bottom: 48px;
    }

    .card {
      display: flex;
      align-items: center;
      justify-content: space-between;
      background-color: rgba(255, 255, 255, 0.05);
      border-radius: 8px;
      width: 100%;
      max-width: 327px;
      height: 80px;
      margin: 0 auto;
      box-sizing: border-box;
      padding-right: 16px;
      transition: background-color 0.2s;
    }

    .card:active {
      background-color: rgba(255, 255, 255, 0.1);
    }

    .card img:first-child {
      width: 118px;
      height: 80px;
      object-fit: cover;
      border-radius: 8px 0 0 8px;
      flex-shrink: 0;
    }

    .card-content {
      display: flex;
      flex-direction: column;
      justify-content: center;
      flex: 1;
      margin-left: 16px;
      gap: 4px;
    }

    .card-title {
      font-size: 16px;
      font-weight: 600;
      line-height: 24px;
      color: var(--white);
    }

    .card-subtitle {
      font-size: 12px;
      color: var(--text-2);
      line-height: 16px;
    }

    .card .arrow {
      width: 5px;
      height: 10px;
      margin-left: 16px;
    }

    /* –ë–ª–æ–∫ "–ï—Å–ª–∏ –Ω–µ —Ö–æ—á–µ—Ç—Å—è –≤—ã–±–∏—Ä–∞—Ç—å" */
    .no-choice-section {
      margin-bottom: 48px;
    }

    .no-choice-text {
      font-size: 16px;
      line-height: 24px;
      font-weight: 700;
      color: #FFFFFF;
      text-align: left;
      margin: 0 auto 4px auto;
      max-width: 327px;
      width: 100%;
    }

    .no-choice-subtitle {
      font-size: 12px;
      line-height: 16px;
      font-weight: 400;
      color: #B3B3B3;
      text-align: left;
      margin: 0 auto 24px auto;
      max-width: 327px;
      width: 100%;
    }

    /* –ê–Ω–∏–º–∞—Ü–∏—è –ø—Ä–∞–∫—Ç–∏–∫–∏ –¥–Ω—è */
    .preview-container {
      width: 100%;
      max-width: 327px;
      height: 120px;
      background-color: var(--green);
      border-radius: 8px;
      position: relative;
      overflow: hidden;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: transform 0.2s;
      user-select: none;
      -webkit-user-select: none;
      touch-action: manipulation;
      margin: 0 auto;
    }

    .preview-container:active {
      transform: scale(0.98);
    }

    .preview-animation {
      width: 100%;
      height: 100%;
      pointer-events: none;
    }

    .arrow {
      width: 5px;
      height: 10px;
    }

    /* –ë–ª–æ–∫ –ø–æ–¥–¥–µ—Ä–∂–∫–∏ */
    .support-block {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 0;
      margin-top: 0;
      padding: 0 12px;
    }

    .support-item {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 12px;
      padding: 4px 16px;
      font-size: 12px;
      line-height: 18px;
      font-weight: 400;
      color: var(--text-2);
      transition: opacity 0.2s;
      cursor: pointer;
    }

    .support-item:hover {
      opacity: 0.8;
    }

    .support-item:active {
      opacity: 0.6;
    }

    .support-item svg {
      flex-shrink: 0;
    }

    /* –ù–∏–∂–Ω—è—è –Ω–∞–≤–∏–≥–∞—Ü–∏—è */
    .tab-bar {
      position: fixed;
      bottom: 0;
      left: 50%;
      transform: translateX(-50%);
      width: 100%;
      max-width: 375px;
      background-color: var(--main);
      border-top: 1px solid rgba(255, 255, 255, 0.15);
      display: flex;
      justify-content: space-around;
      padding: 12px 0;
    }

    .tab {
      display: flex;
      flex-direction: column;
      align-items: center;
      font-size: 12px;
      line-height: 18px;
      font-weight: 400;
      color: var(--text-2);
      gap: 8px;
    }

    .tab.active {
      font-weight: 600;
      color: var(--green);
    }

    .tab.active img {
      filter: brightness(1.5);
    }

    .tab img {
      width: 24px;
      height: 24px;
      transition: transform 0.1s, filter 0.1s;
    }

    .tab img:active {
      transform: scale(0.9);
      filter: brightness(1.5);
    }

    /* TON Connect —Å–∫—Ä—ã—Ç—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã */
    .ton-connect-wrapper {
      margin-left: auto;
      display: none !important;
    }

    .wallet-status {
      position: fixed;
      top: 80px;
      right: 24px;
      background: rgba(0, 136, 204, 0.1);
      border: 1px solid rgba(0, 136, 204, 0.3);
      border-radius: 4px;
      padding: 4px 8px;
      font-size: 10px;
      color: #0088cc;
      opacity: 0;
      transition: opacity 0.3s;
      pointer-events: none;
      display: none;
    }

    .wallet-status.show {
      opacity: 1;
    }
  </style>
</head>
<body>
  <!-- Language Switcher -->
  <div class="language-switcher">
    <button class="lang-btn active" id="enBtn">EN</button>
    <button class="lang-btn" id="ruBtn">RU</button>
  </div>

  <div class="home">
    <!-- –õ–æ–≥–æ—Ç–∏–ø –±—É–¥–µ—Ç –∑–∞–º–µ–Ω–µ–Ω –Ω–∞ –∞–≤–∞—Ç–∞—Ä –∏ –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —á–µ—Ä–µ–∑ JavaScript -->
    <div class="logo" id="headerLogo">
      <img src="img/logo.svg" alt="Potok logo">
    </div>

    <div class="header">
      <div class="text-welcome" data-translate="welcome">Welcome!</div>
      <div class="text-title" data-translate="start_question">Start your day</div>
    </div>

    <div class="cards">
      <a href="pause.html" class="card">
        <img src="img/mind.jpg" alt="Calm thoughts">
        <div class="card-content">
          <div class="card-title" data-translate="calm_thoughts">Calm thoughts</div>
          <div class="card-subtitle" data-translate="meditation_duration">Meditation ‚Ä¢ 5 min</div>
        </div>
        <img class="arrow" src="img/arrow.svg" alt="arrow">
      </a>
      <a href="478.html" class="card">
        <img src="img/breathing.jpg" alt="Reduce stress">
        <div class="card-content">
          <div class="card-title" data-translate="reduce_stress">Reduce stress</div>
          <div class="card-subtitle" data-translate="breathing_duration">Breathing ‚Ä¢ 1-2 min</div>
        </div>
        <img class="arrow" src="img/arrow.svg" alt="arrow">
      </a>
      <a href="stars.html" class="card">
        <img src="img/sleep.jpg" alt="Improve sleep">
        <div class="card-content">
          <div class="card-title" data-translate="improve_sleep">Improve sleep</div>
          <div class="card-subtitle" data-translate="sleep_duration">Sleep ‚Ä¢ 5 min</div>
        </div>
        <img class="arrow" src="img/arrow.svg" alt="arrow">
      </a>
    </div>

    <div class="no-choice-section">
      <h2 class="no-choice-text" data-translate="no_choice_title">If you don't want to choose</h2>
      <p class="no-choice-subtitle" data-translate="pond_practice">Leaves in the pond ‚Ä¢ 3 min</p>

      <div class="preview-container" id="practiceOfDay">
        <svg class="preview-animation" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 327 120">
          <!-- Background -->
          <rect width="327" height="120" fill="#34A853" rx="8" />
          
          <!-- Random white dots -->
          <circle cx="60" cy="25" r="1.5" fill="white" opacity="0.7">
            <animate attributeName="opacity" values="0.7;0.3;0.7" dur="2.5s" repeatCount="indefinite"/>
          </circle>
          <circle cx="270" cy="30" r="2" fill="white" opacity="0.5">
            <animate attributeName="opacity" values="0.5;0.8;0.5" dur="3s" repeatCount="indefinite"/>
          </circle>
          <circle cx="250" cy="90" r="1" fill="white" opacity="0.6">
            <animate attributeName="opacity" values="0.6;0.2;0.6" dur="2s" repeatCount="indefinite"/>
          </circle>
          <circle cx="80" cy="85" r="1.8" fill="white" opacity="0.4">
            <animate attributeName="opacity" values="0.4;0.7;0.4" dur="3.5s" repeatCount="indefinite"/>
          </circle>
          <circle cx="180" cy="20" r="1.2" fill="white" opacity="0.8">
            <animate attributeName="opacity" values="0.8;0.4;0.8" dur="2.2s" repeatCount="indefinite"/>
          </circle>
          <circle cx="300" cy="70" r="1.4" fill="white" opacity="0.6">
            <animate attributeName="opacity" values="0.6;0.9;0.6" dur="2.8s" repeatCount="indefinite"/>
          </circle>
          <circle cx="40" cy="60" r="2.2" fill="white" opacity="0.3">
            <animate attributeName="opacity" values="0.3;0.6;0.3" dur="3.2s" repeatCount="indefinite"/>
          </circle>
          <circle cx="200" cy="100" r="1.6" fill="white" opacity="0.7">
            <animate attributeName="opacity" values="0.7;0.2;0.7" dur="2.4s" repeatCount="indefinite"/>
          </circle>
          
          <!-- 5 –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∏—á–µ—Å–∫–∏—Ö –≤–æ–ª–Ω -->
          <!-- Wave 1 -->
          <circle cx="163.5" cy="60" r="45" fill="rgba(220, 255, 220, 0.5)" opacity="0">
            <animate 
              attributeName="r" 
              values="45;10" 
              dur="8s" 
              repeatCount="indefinite"
              begin="0s"
            />
            <animate 
              attributeName="opacity" 
              values="0;0.5;0.9" 
              dur="8s" 
              repeatCount="indefinite"
              begin="0s"
            />
          </circle>
          
          <!-- Wave 2 -->
          <circle cx="163.5" cy="60" r="45" fill="rgba(220, 255, 220, 0.5)" opacity="0">
            <animate 
              attributeName="r" 
              values="45;10" 
              dur="8s" 
              repeatCount="indefinite"
              begin="1.6s"
            />
            <animate 
              attributeName="opacity" 
              values="0;0.5;0.9" 
              dur="8s" 
              repeatCount="indefinite"
              begin="1.6s"
            />
          </circle>
          
          <!-- Wave 3 -->
          <circle cx="163.5" cy="60" r="45" fill="rgba(220, 255, 220, 0.5)" opacity="0">
            <animate 
              attributeName="r" 
              values="45;10" 
              dur="8s" 
              repeatCount="indefinite"
              begin="3.2s"
            />
            <animate 
              attributeName="opacity" 
              values="0;0.5;0.9" 
              dur="8s" 
              repeatCount="indefinite"
              begin="3.2s"
            />
          </circle>
          
          <!-- Wave 4 -->
          <circle cx="163.5" cy="60" r="45" fill="rgba(220, 255, 220, 0.5)" opacity="0">
            <animate 
              attributeName="r" 
              values="45;10" 
              dur="8s" 
              repeatCount="indefinite"
              begin="4.8s"
            />
            <animate 
              attributeName="opacity" 
              values="0;0.5;0.9" 
              dur="8s" 
              repeatCount="indefinite"
              begin="4.8s"
            />
          </circle>
          
          <!-- Wave 5 -->
          <circle cx="163.5" cy="60" r="45" fill="rgba(220, 255, 220, 0.5)" opacity="0">
            <animate 
              attributeName="r" 
              values="45;10" 
              dur="8s" 
              repeatCount="indefinite"
              begin="6.4s"
            />
            <animate 
              attributeName="opacity" 
              values="0;0.5;0.9" 
              dur="8s" 
              repeatCount="indefinite"
              begin="6.4s"
            />
          </circle>
          
          <!-- Play button overlay -->
          <g transform="translate(163.5, 60)">
            <!-- Button background -->
            <circle r="24" fill="rgba(255, 255, 255, 0.03)" stroke="rgba(255, 255, 255, 0.1)" stroke-width="1"/>
            <!-- Play icon -->
            <path d="M-6 -8 L-6 8 L8 0 Z" fill="white" opacity="0.9"/>
          </g>
        </svg>
      </div>
    </div>

    <!-- Support and Terms block -->
    <div class="support-block">
      <a href="https://t.me/spoksupport_bot" class="support-item">
        <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M17.3666 3.84166C16.941 3.41583 16.4356 3.07803 15.8794 2.84757C15.3232 2.61711 14.7271 2.49847 14.1249 2.49847C13.5227 2.49847 12.9266 2.61711 12.3704 2.84757C11.8142 3.07803 11.3088 3.41583 10.8832 3.84166L9.99989 4.725L9.11656 3.84166C8.25686 2.98196 7.09089 2.49879 5.87489 2.49879C4.65889 2.49879 3.49292 2.98196 2.63322 3.84166C1.77352 4.70136 1.29036 5.86733 1.29036 7.08333C1.29036 8.29933 1.77352 9.4653 2.63322 10.325L3.51656 11.2083L9.99989 17.6917L16.4832 11.2083L17.3666 10.325C17.7924 9.89937 18.1302 9.39399 18.3607 8.83779C18.5911 8.28158 18.7098 7.68546 18.7098 7.08333C18.7098 6.48121 18.5911 5.88508 18.3607 5.32888C18.1302 4.77267 17.7924 4.26729 17.3666 3.84166Z" stroke="#B3B3B3" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
        <span data-translate="support_text">Need help? Contact us!</span>
      </a>
      
      <a href="privacy.html" class="support-item">
        <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M4 4H16V16H4V4Z" stroke="#B3B3B3" stroke-width="1.5"/>
          <path d="M6 8H14" stroke="#B3B3B3" stroke-width="1.5" stroke-linecap="round"/>
          <path d="M6 11H14" stroke="#B3B3B3" stroke-width="1.5" stroke-linecap="round"/>
          <path d="M6 14H10" stroke="#B3B3B3" stroke-width="1.5" stroke-linecap="round"/>
        </svg>
        <span data-translate="terms_of_use">Terms of Use</span>
      </a>
    </div>
  </div>

  <!-- TON Wallet Status -->
  <div class="wallet-status" id="walletStatus">
    <span data-translate="wallet_not_connected">Wallet not connected</span>
  </div>

  <footer class="tab-bar">
    <a href="index.html" class="tab active">
      <img src="img/home-active.svg" alt="Today">
      <div data-translate="today">Today</div>
    </a>
    <a href="practices.html" class="tab">
      <img src="img/practices.svg" alt="Practices">
      <div data-translate="practices">Practices</div>
    </a>
    <a href="journal.html" class="tab">
      <img src="img/journal.svg" alt="Journal">
      <div data-translate="journal">Journal</div>
    </a>
  </footer>

  <script>
    // Translation system
    const translations = {
      en: {
        page_title: "Potok ‚Äî Home",
        welcome: "Welcome!",
        start_question: "Start your day",
        calm_thoughts: "Calm thoughts",
        reduce_stress: "Reduce stress", 
        improve_sleep: "Improve sleep",
        meditation_duration: "Meditation ‚Ä¢ 5 min",
        breathing_duration: "Breathing ‚Ä¢ 1-2 min",
        sleep_duration: "Sleep ‚Ä¢ 5 min",
        no_choice_title: "If you don't want to choose",
        pond_practice: "Leaves in the pond ‚Ä¢ 3 min",
        support_text: "Need help? Contact us!",
        terms_of_use: "Terms of Use",
        wallet_not_connected: "Wallet not connected",
        today: "Today",
        practices: "Practices",
        journal: "Journal"
      },
      ru: {
        page_title: "Potok ‚Äî –î–æ–º",
        welcome: "–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!",
        start_question: "–° —á–µ–≥–æ —Ö–æ—á–µ—à—å –Ω–∞—á–∞—Ç—å?",
        calm_thoughts: "–£—Å–ø–æ–∫–æ–∏—Ç—å –º—ã—Å–ª–∏",
        reduce_stress: "–°–Ω–∏–∑–∏—Ç—å —Å—Ç—Ä–µ—Å—Å",
        improve_sleep: "–£–ª—É—á—à–∏—Ç—å —Å–æ–Ω", 
        meditation_duration: "–ú–µ–¥–∏—Ç–∞—Ü–∏—è ‚Ä¢ 5 –º–∏–Ω",
        breathing_duration: "–î—ã—Ö–∞–Ω–∏–µ ‚Ä¢ 1-2 –º–∏–Ω",
        sleep_duration: "–°–æ–Ω ‚Ä¢ 5 –º–∏–Ω",
        no_choice_title: "–ï—Å–ª–∏ –Ω–µ —Ö–æ—á–µ—Ç—Å—è –≤—ã–±–∏—Ä–∞—Ç—å",
        pond_practice: "–õ–∏—Å—Ç—å—è –≤ –ø—Ä—É–¥—É ‚Ä¢ 3 –º–∏–Ω",
        support_text: "–ù—É–∂–Ω–∞ –ø–æ–º–æ—â—å? –°–≤—è–∂–∏—Ç–µ—Å—å —Å –Ω–∞–º–∏!",
        terms_of_use: "–£—Å–ª–æ–≤–∏—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è",
        wallet_not_connected: "–ö–æ—à–µ–ª–µ–∫ –Ω–µ –ø–æ–¥–∫–ª—é—á–µ–Ω",
        today: "–°–µ–≥–æ–¥–Ω—è",
        practices: "–ü—Ä–∞–∫—Ç–∏–∫–∏", 
        journal: "–ñ—É—Ä–Ω–∞–ª"
      }
    };

    class Translator {
      constructor() {
        // –ù–ï –∏—Å–ø–æ–ª—å–∑—É–µ–º localStorage –≤ Claude Artifacts
        this.currentLang = 'en';  // English –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –¥–ª—è Telegram App Center
        this.init();
      }

      init() {
        this.updatePage();
        this.updateLanguageButtons();
        this.setupLanguageButtons();
      }

      setupLanguageButtons() {
        document.getElementById('enBtn')?.addEventListener('click', () => {
          this.setLanguage('en');
        });
        
        document.getElementById('ruBtn')?.addEventListener('click', () => {
          this.setLanguage('ru');
        });
      }

      setLanguage(lang) {
        this.currentLang = lang;
        
        // –í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –∑–¥–µ—Å—å –±—É–¥–µ—Ç localStorage:
        // if (typeof(Storage) !== "undefined") {
        //   localStorage.setItem('potok_language', lang);
        // }
        
        this.updatePage();
        this.updateLanguageButtons();
        
        // Update document lang attribute
        document.documentElement.lang = lang;
        
        console.log(`üåê Language changed to: ${lang}`);
      }

      translate(key) {
        return translations[this.currentLang]?.[key] || translations.en[key] || key;
      }

      updatePage() {
        // Update all elements with data-translate attribute
        document.querySelectorAll('[data-translate]').forEach(element => {
          const key = element.getAttribute('data-translate');
          const translation = this.translate(key);
          
          if (element.tagName === 'TITLE') {
            element.textContent = translation;
          } else {
            element.textContent = translation;
          }
        });
      }

      updateLanguageButtons() {
        document.querySelectorAll('.lang-btn').forEach(btn => {
          btn.classList.remove('active');
          if (btn.textContent.toLowerCase() === this.currentLang) {
            btn.classList.add('active');
          }
        });
      }
    }

    // Initialize Telegram Mini App with all required SDKs
    class PotokTelegramApp {
      constructor() {
        this.tg = window.Telegram?.WebApp;
        this.tonConnectUI = null;
        this.user = null;
        
        this.init();
      }

      async init() {
        console.log('üöÄ Initializing Potok Telegram Mini App...');
        
        // Initialize Telegram Web App SDK
        this.initTelegramWebApp();
        
        // Initialize TON Connect SDK
        await this.initTONConnect();
        
        // Initialize Analytics tracking
        this.initAnalytics();
        
        // Setup Event Listeners
        this.setupEventListeners();
        
        console.log('‚úÖ All SDKs initialized successfully!');
      }

      initTelegramWebApp() {
        if (!this.tg) {
          console.log('‚ö†Ô∏è Running outside Telegram, using test data');
          this.user = {
            id: 12345,
            first_name: "–ê–Ω–Ω–∞", 
            last_name: "–ò–≤–∞–Ω–æ–≤–∞",
            username: "anna_test",
            photo_url: null
          };
          console.log('üë§ Test user data set:', this.user);
          this.updateUserHeader();
          return;
        }

        console.log('‚úÖ Telegram Web App SDK detected');
        
        // Configure Telegram Web App
        this.tg.ready();
        
        // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ü–≤–µ—Ç–æ–≤ —Å—Ç–∞—Ç—É—Å-–±–∞—Ä–∞ –∏ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
        this.tg.setHeaderColor('#19191B');
        this.tg.setBackgroundColor('#19191B');
        
        // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Ü–≤–µ—Ç–æ–≤–æ–π —Å—Ö–µ–º—ã
        if (this.tg.setBottomBarColor) {
          this.tg.setBottomBarColor('#19191B');
        }
        
        // Initialize Telegram Analytics with error handling
        try {
          if (typeof TelegramMiniAppsAnalytics !== 'undefined') {
            TelegramMiniAppsAnalytics.init('your_app_id'); // –∑–∞–º–µ–Ω–∏—à—å –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã–π ID
            console.log('‚úÖ Official Telegram Analytics initialized');
          } else {
            console.log('‚ö†Ô∏è Official Telegram Analytics not loaded');
          }
        } catch (error) {
          console.error('‚ùå Telegram Analytics initialization failed:', error);
        }
        
        this.tg.expand();
        this.tg.enableClosingConfirmation();
        
        // Hide default Telegram buttons
        this.tg.MainButton.hide();
        this.tg.BackButton.hide();
        
        // Get user data from Telegram
        this.user = this.tg.initDataUnsafe?.user;
        if (this.user) {
          console.log('üë§ User data received:', this.user);
          this.updateUserHeader();
        }

        // Apply Telegram theme colors
        if (this.tg.themeParams) {
          document.documentElement.style.setProperty('--tg-bg', this.tg.themeParams.bg_color || '#19191B');
          document.documentElement.style.setProperty('--tg-text', this.tg.themeParams.text_color || '#ffffff');
        }
      }

      async initTONConnect() {
        try {
          // Initialize TON Connect UI with minimal configuration
          if (typeof TON_CONNECT_UI !== 'undefined') {
            this.tonConnectUI = new TON_CONNECT_UI.TonConnectUI({
              manifestUrl: window.location.origin + '/tonconnect-manifest.json'
            });

            // Listen for wallet connection status changes
            this.tonConnectUI.onStatusChange((walletInfo) => {
              this.handleWalletConnection(walletInfo);
            });

            console.log('‚úÖ TON Connect SDK initialized');
          } else {
            console.log('‚ö†Ô∏è TON Connect UI not loaded, creating fallback');
            this.createTONConnectFallback();
          }
        } catch (error) {
          console.error('‚ùå TON Connect initialization failed:', error);
          this.createTONConnectFallback();
        }
      }

      createTONConnectFallback() {
        // Create a simple TON Connect button in the header (–ø–æ–ª–Ω–æ—Å—Ç—å—é —Å–∫—Ä—ã—Ç)
        const headerLogo = document.getElementById('headerLogo');
        if (this.user) {
          // If user is logged in, show user info only (–±–µ–∑ –∫–Ω–æ–ø–∫–∏ TON)
          headerLogo.innerHTML = `
            <div class="user-header">
              <div class="user-avatar">
                ${this.user.photo_url ? 
                  `<img src="${this.user.photo_url}" alt="${this.user.first_name}" class="avatar-image">` :
                  `<div class="avatar-placeholder">${this.user.first_name?.charAt(0).toUpperCase() || '–ü'}</div>`
                }
              </div>
              <div class="user-name">${this.user.first_name || '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å'}</div>
            </div>
            <!-- TON Connect –∫–Ω–æ–ø–∫–∞ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç, –Ω–æ –ø–æ–ª–Ω–æ—Å—Ç—å—é –Ω–µ–≤–∏–¥–∏–º–∞ -->
            <button class="ton-connect-button" id="tonConnectBtn" style="display: none; position: absolute; visibility: hidden;">TON</button>
          `;
        } else {
          // Show just the logo (–±–µ–∑ –∫–Ω–æ–ø–∫–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫–æ—à–µ–ª—å–∫–∞)
          headerLogo.innerHTML = `
            <img src="img/logo.svg" alt="Potok logo" style="height: 33px;">
            <!-- TON Connect –∫–Ω–æ–ø–∫–∞ —Å–∫—Ä—ã—Ç–∞, –Ω–æ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞ -->
            <button class="ton-connect-button" id="tonConnectBtn" style="display: none; position: absolute; visibility: hidden;">–ü–æ–¥–∫–ª—é—á–∏—Ç—å –∫–æ—à–µ–ª–µ–∫</button>
          `;
        }

        // Add click handler (—Ä–∞–±–æ—Ç–∞–µ—Ç –≤ —Ñ–æ–Ω–µ)
        const tonBtn = document.getElementById('tonConnectBtn');
        if (tonBtn) {
          tonBtn.addEventListener('click', () => {
            this.showWalletStatus('TON Connect –∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç—Å—è...');
            // In real app, this would open TON Connect modal
          });
        }
      }

      updateUserHeader() {
        if (!this.user) {
          console.log('‚ùå No user data for header update');
          return;
        }
        
        console.log('üîÑ Updating user header with:', this.user);
        
        const headerLogo = document.getElementById('headerLogo');
        headerLogo.innerHTML = `
          <div class="user-header">
            <div class="user-avatar">
              ${this.user.photo_url ? 
                `<img src="${this.user.photo_url}" alt="${this.user.first_name}" class="avatar-image">` :
                `<div class="avatar-placeholder">${this.user.first_name?.charAt(0).toUpperCase() || '–ü'}</div>`
              }
            </div>
            <div class="user-name">${this.user.first_name || '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å'}</div>
          </div>
          <!-- TON Connect –∫–Ω–æ–ø–∫–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Å–∫—Ä—ã—Ç–∞, –Ω–æ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞ -->
          <button class="ton-connect-button" id="tonConnectBtn" style="display: none; position: absolute; visibility: hidden;">TON</button>
        `;

        console.log('‚úÖ User header updated successfully');

        // Re-attach TON Connect button handler (—Ä–∞–±–æ—Ç–∞–µ—Ç –≤ —Ñ–æ–Ω–µ)
        const tonBtn = document.getElementById('tonConnectBtn');
        if (tonBtn) {
          tonBtn.addEventListener('click', () => {
            if (this.tonConnectUI) {
              this.tonConnectUI.openModal();
            } else {
              this.showWalletStatus('TON Connect –∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç—Å—è...');
            }
          });
        }
      }

      initAnalytics() {
        // Track app initialization
        this.trackEvent('app_initialized', {
          user_id: this.user?.id,
          timestamp: Date.now(),
          platform: 'telegram_mini_app'
        });

        console.log('‚úÖ Telegram Mini Apps Analytics SDK initialized');
      }

      setupEventListeners() {
        // Practice of the day button
        const practiceBtn = document.getElementById('practiceOfDay');
        if (practiceBtn) {
          practiceBtn.addEventListener('click', () => {
            this.handlePracticeClick('practice_of_day');
            this.triggerHapticFeedback('medium');
            window.location.href = 'pond.html';
          });
        }

        // Practice cards
        document.querySelectorAll('.card').forEach(card => {
          card.addEventListener('click', (e) => {
            const title = e.currentTarget.querySelector('.card-title')?.textContent;
            this.handlePracticeClick(title);
            this.triggerHapticFeedback('light');
          });
        });

        // Navigation tabs
        document.querySelectorAll('.tab').forEach(tab => {
          tab.addEventListener('click', (e) => {
            const tabName = e.currentTarget.querySelector('div')?.textContent;
            this.trackEvent('navigation_click', {
              tab: tabName,
              user_id: this.user?.id
            });
            this.triggerHapticFeedback('selection');
          });
        });
      }

      handleWalletConnection(walletInfo) {
        if (walletInfo) {
          this.showWalletStatus('–ö–æ—à–µ–ª–µ–∫ –ø–æ–¥–∫–ª—é—á–µ–Ω');
          this.trackEvent('wallet_connected', {
            wallet: walletInfo.device?.appName || 'unknown',
            user_id: this.user?.id
          });
        } else {
          this.showWalletStatus('–ö–æ—à–µ–ª–µ–∫ –æ—Ç–∫–ª—é—á–µ–Ω');
          this.trackEvent('wallet_disconnected', {
            user_id: this.user?.id
          });
        }
      }

      handlePracticeClick(practiceType) {
        console.log(`üßò Starting practice: ${practiceType}`);
        
        this.trackEvent('practice_started', {
          practice_type: practiceType,
          user_id: this.user?.id,
          timestamp: Date.now()
        });
      }

      triggerHapticFeedback(type = 'light') {
        if (this.tg?.HapticFeedback) {
          switch (type) {
            case 'light':
              this.tg.HapticFeedback.impactOccurred('light');
              break;
            case 'medium':
              this.tg.HapticFeedback.impactOccurred('medium');
              break;
            case 'heavy':
              this.tg.HapticFeedback.impactOccurred('heavy');
              break;
            case 'selection':
              this.tg.HapticFeedback.selectionChanged();
              break;
          }
        }
      }

      showWalletStatus(message) {
        const statusEl = document.getElementById('walletStatus');
        statusEl.textContent = message;
        statusEl.classList.add('show');
        
        setTimeout(() => {
          statusEl.classList.remove('show');
        }, 3000);
      }

      trackEvent(eventName, parameters = {}) {
        // Use Telegram Analytics wrapper
        if (window.TelegramAnalytics) {
          window.TelegramAnalytics.track(eventName, parameters);
        }

        // Also log for debugging
        console.log(`üìä Event: ${eventName}`, parameters);
      }
    }

    // Initialize translator first
    window.translator = new Translator();

    // Initialize the app when DOM is loaded
    document.addEventListener('DOMContentLoaded', () => {
      window.potokApp = new PotokTelegramApp();
    });

    // Manifest for TON Connect (this would normally be a separate file)
    const tonConnectManifest = {
      "url": window.location.origin,
      "name": "Potok - –ú–µ–¥–∏—Ç–∞—Ü–∏—è –∏ –æ—Å–æ–∑–Ω–∞–Ω–Ω–æ—Å—Ç—å",
      "iconUrl": window.location.origin + "/img/logo.svg",
      "termsOfUseUrl": window.location.origin + "/terms",
      "privacyPolicyUrl": window.location.origin + "/privacy"
    };

    // Create manifest file dynamically (for demo purposes)
    const blob = new Blob([JSON.stringify(tonConnectManifest, null, 2)], {
      type: 'application/json'
    });
    const manifestUrl = URL.createObjectURL(blob);
    
  </script>
</body>
</html>